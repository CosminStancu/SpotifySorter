<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Spotify Profile Viewer</title>
</head>
<body>
  <h1>Conectarse a Spotify</h1>
  <button onclick="login()">Iniciar sesi√≥n con Spotify</button>
  <div id="profile" style="margin-top: 20px;"></div>

  <script>
    const clientId = 'a5f2624086b74a51b612a150160324ba'; // Sustituye esto por tu client ID
    const redirectUri = window.location.href.split('#')[0];
    const scopes = 'user-read-private user-read-email';

    function login() {
      const authUrl = `https://accounts.spotify.com/authorize?response_type=token&client_id=${clientId}&scope=${encodeURIComponent(scopes)}&redirect_uri=${encodeURIComponent(redirectUri)}`;
      window.location.href = authUrl;
    }

    function getAccessTokenFromUrl() {
      const hash = window.location.hash;
      if (!hash) return null;
      const params = new URLSearchParams(hash.substring(1));
      return params.get('access_token');
    }

    async function fetchProfile(token) {
      const response = await fetch('https://api.spotify.com/v1/me', {
        headers: { 'Authorization': 'Bearer ' + token }
      });
      const data = await response.json();
      document.getElementById('profile').innerHTML = `
        <p><strong>Nombre:</strong> ${data.display_name}</p>
        <p><strong>Email:</strong> ${data.email}</p>
        <p><strong>ID:</strong> ${data.id}</p>
        <p><img src="${data.images[0]?.url}" width="100" /></p>
      `;
    }

    const token = getAccessTokenFromUrl();
    if (token) {
      window.history.pushState("", document.title, redirectUri); // limpia el token de la URL
      fetchProfile(token);
    }
  </script>
</body>
</html>
